document.addEventListener("DOMContentLoaded",(()=>{const e=e=>{const t=window.innerWidth;t>=1200&&(e.style.zoom=(t-1200)/720*.5+1)};[".uc-scale-container",".uc-step_title1",".uc-step_title2",".uc-res"].forEach((t=>{const n=(e=>{if(e.startsWith("#")){const t=document.getElementById(e.slice(1));return t?[t]:[]}return e.startsWith(".")?Array.from(document.querySelectorAll(e)):[]})(t);n.forEach((t=>{e(t),window.addEventListener("resize",(()=>e(t)))}))})),t_onReady((function(){t_onFuncLoad("t396_init",(function(){const e=500,t={};let n=null,r=null,a=null,o=null,s=null,l=null,i=null,c=null,d=null,u=null,p=null,m=null,y=!1,g=localStorage.getItem("ai_lang")||"input";const h={"العربية":"arabic","الإنجليزية":"english","الالمانية":"german","الإسبانية":"spanish","الفرنسية":"french","الروسية":"russian"};localStorage.setItem("ai_lang","input"),t.ai_lang=g;function f(){if(!r||!a)return;let t=r.value.trim();""!==t&&o?o.classList.remove("disabled"):o&&o.classList.add("disabled"),t.length>e&&(t=t.substring(0,e).trim(),r.value=t);const n=a.querySelector(".tn-atom");n&&(n.innerHTML=`${t.length} / 500`,t.length>=e?(n.classList.remove("gc"),n.classList.add("ec")):(n.classList.remove("ec"),n.classList.add("gc")))}async function L(){if(!o||!r||!u||o.classList.contains("disabled"))return;let n=r.value.trim();if(n.length>e)return;t.prompt=n,o.classList.add("disabled");const a=o.querySelector(".tn-atom");a&&(a.classList.add("progress"),a.innerHTML="ثواني ..."),s&&s.classList.add("disabled"),g=localStorage.getItem("ai_lang")||"input",u&&(u.innerHTML="");try{const e=await fetch("https://api.plz-ai.me/v1/gp",{method:"POST",headers:{"Content-Type":"text/plain"},body:JSON.stringify(t)});if(!e.ok){await e.text();throw new Error(`Network response error: ${e.status}`)}window.location.hash="#step2",u&&(u.style.fontFamily=g&&"arabic"!==g&&"input"!==g?"TildaSans":"Cairo");const n=e.body.getReader(),r=new TextDecoder,l=async({done:e,value:t})=>{if(e)return s&&s.classList.remove("disabled"),o&&a&&(o.classList.remove("disabled"),a.innerHTML="ظبط الكلام",a.classList.remove("progress")),void history.replaceState(null,"",window.location.pathname+window.location.search);const i=r.decode(t,{stream:!0});return u&&(u.textContent+=i),n.read().then(l)};await n.read().then(l)}catch(e){if(window.location.hash="#step2",setTimeout((()=>{history.replaceState(null,"",window.location.pathname+window.location.search)}),100),u){let t;t="TypeError"===e.name&&e.message.includes("Failed to fetch")?"arabic"!==g&&"input"!==g?"Network connection error. Please check your internet connection.":"في مشكلة في الاتصال بالإنترنت. تأكد من اتصالك بالإنترنت.":"arabic"!==g&&"input"!==g?"Sorry, ERROR.\nDon't worry, just try again later!":"للأسف فيه مشكلة بسيطة.\nما تزعلش وحاول تاني بعد شوية.",u.innerHTML=t}o&&(o.classList.remove("disabled"),a&&(a.innerHTML="ظبط الكلام",a.classList.remove("progress")))}}new Observer("#allrecords",{debounce:50}).listenToElement("#allrecords",{onFound:m=>{if(n=m[0],r=n.querySelector('textarea[name="origPrompt"]'),a=n.querySelector(".pxb-char-count"),o=n.querySelector(".pxb-enhance"),s=n.querySelector(".uc-copy-prompt"),p=n.querySelector(".uc-step_title2"),i=n.querySelector(".uc-res"),a){const e=a.querySelector(".tn-atom");e&&e.classList.add("gc")}s&&(l=s.querySelector(".pxb-copy-prompt"),s.classList.add("disabled")),i&&(c=i.querySelector(".t004 .t-container"),c&&(d=c.querySelector(".t-text"),d&&(d.innerHTML='<pre class="pxb-response" style="height:auto;"></pre>',u=i.querySelector(".pxb-response")))),r&&(""!==r.value.trim()&&r.value.trim().length<=e&&(t.prompt=r.value.trim()),r.addEventListener("input",f),f()),o&&(o.classList.add("disabled"),o.addEventListener("click",L)),l&&l.addEventListener("click",(function(){!function(e){if(!u)return;let t=e.querySelector(".tn-atom");if(!t)return;let n=t.innerText,r=u.textContent;navigator.clipboard.writeText(r).then((()=>{t.innerText="تمام, أخدنا الكوبي",setTimeout((()=>{t.innerText=n}),3e3)})).catch((e=>{}))}(this)}))}}),new Observer(".pxb-form-lang",{trackReferences:!0,debounce:100}).listenToClass("zero-form-rendered",{onFound:e=>{const n=e[0].querySelector('select.t-select[name="res_lang"]');n&&!y&&function(e){if(!e)return;m=function(e){u&&(u.innerHTML=""),s&&s.classList.add("disabled");const n=e.target.value;n?localStorage.setItem("ai_lang",h[n]):localStorage.setItem("ai_lang","input"),g=localStorage.getItem("ai_lang")||"input",t.ai_lang=g,c&&d&&("arabic"!==g&&"input"!==g?(c.style.textAlign="left",d.style.direction="ltr",d.style.fontFamily="TildaSans"):(c.style.textAlign="",d.style.direction="",d.style.fontFamily="Cairo"))},e.removeEventListener("change",m),e.addEventListener("change",m),y=!0}(n)},onRemoved:e=>{e.length>0&&function(e){if(!e)return;const t=e.querySelector('select.t-select[name="res_lang"]');t&&m&&(t.removeEventListener("change",m),y=!1)}(e[0])}});var v=new XMLHttpRequest;v.open("GET","https://geo.tildacdn.com/geo/country/",!0),v.onload=function(){if(v.status>=200&&v.status<400&&"RU"!==v.responseText){var e=document.querySelectorAll(".uc-blocked");Array.prototype.forEach.call(e,(function(e){e.style.display="none"}))}},v.send()}))}))}));